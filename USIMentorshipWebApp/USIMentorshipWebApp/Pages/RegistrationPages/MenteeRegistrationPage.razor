@page "/mentee-registration"
@layout NotLoggedInLayout

@inject NavigationManager NavigationManager
@inject DialogService DialogService
@using USIMentorshipWebApp.Models;
@using USIMentorshipWebApp.Data;

<PageTitle>Mentee Sign Up - USI Mentorship Program</PageTitle>

<div class="default-margin">
    <h1>Sign up as a Mentee</h1>

    <RadzenRow class="mb-4 mt-4" Gap="25">
        @* FIRST NAME *@
        <RadzenFormField Text="First Name:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value=@inputtedFirstName />
            <RadzenRequiredValidator Component="FirstName" Text="First name is required" Style="position: absolute" />
        </RadzenFormField>

        @* LAST NAME *@
        <RadzenFormField Text="Last Name:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value="@inputtedLastName" />
        </RadzenFormField>
    </RadzenRow>

    <RadzenRow class="mb-4" Gap="25">
        @* EMAIL *@
        <RadzenFormField Text="Email:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value="@inputtedEmail" />
        </RadzenFormField>

        @* PHONE NUMBER *@
        <RadzenFormField Text="Phone Number:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value="@inputtedPhoneNumber" />
        </RadzenFormField>
    </RadzenRow>

    <RadzenRow class="mb-4" Gap="25">
        @* LINKEDIN *@
        <RadzenFormField Text="Paste LinkedIn Profile URL:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value="@inputtedLinkedInProfileURL" />
        </RadzenFormField>
    </RadzenRow>

    <RadzenRow class="mb-4">
        @* UPLOAD PROFILE PICTURE *@
        <RadzenUpload Url="upload/single" ChooseText="Upload Profile Picture" Style="width:180px; text-align:center;" Accept="image/*"></RadzenUpload>
    </RadzenRow>

    <h3>Further Profile Info</h3>
    <h6>Additional information may lead to more connections with mentors</h6>
    <RadzenRow class="mb-4 mt-4" Gap="25" AlignItems="AlignItems.Center">
        @* SELF-INTRODUCTION *@
        <div class="our-column">
            <label>Self-Introduction</label>
            <RadzenTextArea @bind-Value=@inputtedSelfIntroduction Cols="80" Rows="6" aria-label=Self-Introduction: />
        </div>
    </RadzenRow>

    <RadzenRow class="mb-4 mt-4" Gap="25">
        @* MAJOR *@
        <RadzenFormField Text="Major:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value=@inputtedMajor />
        </RadzenFormField>

        @* MINOR *@
        <RadzenFormField Text="Minor:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenTextBox @bind-Value="@inputtedMinor" />
        </RadzenFormField>
    </RadzenRow>

    <h3>Create a Password</h3>
    <RadzenRow class="mb-4 mt-4" Gap="25">
        @* PASSWORD *@
        <RadzenFormField Text="Password:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenPassword @bind-Value="@inputtedPassword" />
        </RadzenFormField>

        @* CONFIRM PASSWORD *@
        <RadzenFormField Text="Confirm Password:" AllowFloatingLabel="false" Variant=Variant.Flat>
            <RadzenPassword @bind-Value="@inputtedPassword" />
        </RadzenFormField>
    </RadzenRow>

    <RadzenRow>
        <RadzenButton Style="width:100px; font-size:14px;" ButtonType="ButtonType.Submit" Variant="Variant.Outlined" ButtonStyle="ButtonStyle.Secondary" Click=@RegisterUser Text="Register" />
        <RadzenButton Style="width:100px; font-size:14px;" Variant="Variant.Outlined" ButtonStyle="ButtonStyle.Secondary" Click=@GoToLogin Text="Back To Login" />
    </RadzenRow>
</div>

@code {
    string inputtedFirstName = "";
    string inputtedLastName = "";
    string inputtedEmail = "";
    string? inputtedMajor;
    string? inputtedMinor;
    string inputtedPassword = "";
    string inputtedPasswordConfirmed = "";
    string? inputtedPhoneNumber;
    string inputtedLinkedInProfileURL = "";
    string inputtedSelfIntroduction = "";
    string inputtedGender = "";

    private UserService _userService = new UserService();

    void RegisterUser(MouseEventArgs args)
    {
        // needs to make the user account by populating

        //NavigationManager.NavigateTo("/mentor-match");
        User user = new User
        {
            FirstName = inputtedFirstName,
            LastName = inputtedLastName,
            EmailAddress = inputtedEmail,
            Password = inputtedPassword,
            ProfilePicutre = "profilePic.jpg",
            LinkedInLink = inputtedLinkedInProfileURL,
            Bio = inputtedSelfIntroduction,
            Status = "Active",
            Major = inputtedMajor,
            Minor = inputtedMinor,
            Gender = inputtedGender
        };

        // add the user
        _userService.AddUser(user);

        // go to the next page after making the user
        NavigationManager.NavigateTo("/mentor-match");
    }

    void GoToLogin(MouseEventArgs args)
    {
        NavigationManager.NavigateTo("/");
    }
}